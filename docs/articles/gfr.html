<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimated glomerular filtration rate (eGFR) calculation • kidney.epi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Estimated glomerular filtration rate (eGFR) calculation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kidney.epi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/gfr.html">Estimated glomerular filtration rate (eGFR) calculation</a></li>
    <li><a class="dropdown-item" href="../articles/ktx.html">Kidney transplantation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/services.html">Services</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimated glomerular filtration rate (eGFR) calculation</h1>
                        <h4 data-toc-skip class="author">Boris Bikbov,
<a href="https://Scientific-Tools.Org" class="external-link">Scientific-Tools.Org</a>
</h4>
            
            <h4 data-toc-skip class="date">2025-03-31</h4>
      

      <div class="d-none name"><code>gfr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="estimated-glomerular-filtration-rate-egfr-calculation">Estimated glomerular filtration rate (eGFR) calculation<a class="anchor" aria-label="anchor" href="#estimated-glomerular-filtration-rate-egfr-calculation"></a>
</h2>
<p>kidney.epi R package includes functions for calculation of eGFR by
different equations.</p>
<div class="section level3">
<h3 id="data-frames">Data frames<a class="anchor" aria-label="anchor" href="#data-frames"></a>
</h3>
<ul>
<li>ckd.data - contains synthetic data for 1000 adults and 1000 children
(<em>see description in documentation</em>).</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Scientific-Tools.Org/support-us/" class="external-link">kidney.epi</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; The kidney.epi package is made with care by the research consultancy Scientific-Tools.Org.</span></span>
<span><span class="co">#&gt; Contact us at https://Scientific-Tools.Org or via 'maintainer("kidney.epi")' for data analysis or software development.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ckd.data</span><span class="op">)</span></span>
<span><span class="co">#&gt;       cr  cys  age    sex ethnicity height category</span></span>
<span><span class="co">#&gt; 1 108.10 1.29 73.8   Male Caucasian     NA   adults</span></span>
<span><span class="co">#&gt; 2 101.12 1.26 66.8   Male Caucasian     NA   adults</span></span>
<span><span class="co">#&gt; 3 139.99 1.63 75.9   Male Caucasian     NA   adults</span></span>
<span><span class="co">#&gt; 4 145.26 1.75 68.1 Female Caucasian     NA   adults</span></span>
<span><span class="co">#&gt; 5 148.21 1.74 51.7 Female Caucasian     NA   adults</span></span>
<span><span class="co">#&gt; 6 179.43 2.14 41.8   Male Caucasian     NA   adults</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="functions-to-calculate-egfr-by-different-equations">Functions to calculate eGFR by different equations<a class="anchor" aria-label="anchor" href="#functions-to-calculate-egfr-by-different-equations"></a>
</h3>
<p>kidney.epi contains a set of functions to calculate eGFR by different
equations either for a single patient or for a dataset.</p>
<p>The following eGFR equations are supported:</p>
<ul>
<li>CKD-EPI 2021 creatinine-based: function
<code><a href="../reference/egfr.ckdepi.cr.2021.html">egfr.ckdepi.cr.2021()</a></code> and its alias
<code><a href="../reference/egfr.ckdepi.cr.html">egfr.ckdepi.cr()</a></code><br>
</li>
<li>CKD-EPI 2021 cystatin-based: function
<code><a href="../reference/egfr.ckdepi.cr_cys.2021.html">egfr.ckdepi.cr_cys.2021()</a></code><br>
</li>
<li>CKD-EPI 2009 creatinine-based: function
<code><a href="../reference/egfr.ckdepi.cr.2009.html">egfr.ckdepi.cr.2009()</a></code><br>
</li>
<li>European Kidney Function Consortium (EKFC) creatinine-based:
function <code><a href="../reference/egfr.ekfc.cr.html">egfr.ekfc.cr()</a></code><br>
</li>
<li>EKFC cystatin-based: function <code><a href="../reference/egfr.ekfc.cys.html">egfr.ekfc.cys()</a></code><br>
</li>
<li>Full age spectrum (FAS) creatinine-based: function
<code><a href="../reference/egfr.fas.cr.html">egfr.fas.cr()</a></code><br>
</li>
<li>FAS cystatin-based: function <code><a href="../reference/egfr.fas.cys.html">egfr.fas.cys()</a></code><br>
</li>
<li>FAS creatinine-cystatin-based: function
<code><a href="../reference/egfr.fas.cr_cys.html">egfr.fas.cr_cys()</a></code><br>
</li>
<li>Revised Lund-Malmö creatinine-based: function
<code><a href="../reference/egfr.lm.cr.html">egfr.lm.cr()</a></code><br>
</li>
<li>MDRD: function <code><a href="../reference/egfr.mdrd4.html">egfr.mdrd4()</a></code><br>
</li>
<li>Lund-Malmö: function <code><a href="../reference/egfr.lm.cr.html">egfr.lm.cr()</a></code><br>
</li>
<li>Schwartz: function <code><a href="../reference/egfr.schwartz.html">egfr.schwartz()</a></code><br>
</li>
<li>Chronic Kidney Disease in Children (CKiD) U25 creatinine-based
equation <code><a href="../reference/egfr.ckid_u25.cr.html">egfr.ckid_u25.cr()</a></code><br>
</li>
<li>CKiD U25 cystatin-based equation
<code><a href="../reference/egfr.ckid_u25.cys.html">egfr.ckid_u25.cys()</a></code><br>
</li>
<li>more is underway. <a href="https://Scientific-Tools.Org" class="external-link">Scientific-Tools.Org</a> provides
research and consulting services for policy makers, industry,
scientists, patient organizations, and citizens. This package is
developed in our free time or with <a href="https://Scientific-Tools.Org/support-us/" class="external-link">your support</a>.</li>
</ul>
<p>If you use these functions from kidney.epi package for the data
analysis and manuscript preparation, please cite the package: “Bikbov B.
kidney.epi: Kidney-Related Functions for Clinical and Epidemiological
Research. Scientific-Tools.Org, <a href="https://Scientific-Tools.Org" class="external-link uri">https://Scientific-Tools.Org</a>. <a href="doi:10.32614/CRAN.package.kidney.epi" class="uri">doi:10.32614/CRAN.package.kidney.epi</a>”.</p>
<p>Contact us for data analysis or software development at <a href="https://Scientific-Tools.Org/contact/" class="external-link">Scientific-Tools.Org</a> or
via ‘maintainer(“kidney.epi”)’, connect with the <a href="https://www.linkedin.com/in/boris-bikbov/" class="external-link">author on
LinkedIn</a>.</p>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>The vignette demonstrates the usage of eGFR calculation by the
CKD-EPI 2009 equation, but race-free CKD-EPI 2021 and other equations
work in the same way.</p>
<div class="section level4">
<h4 id="example-for-a-single-patient">Example for a single patient<a class="anchor" aria-label="anchor" href="#example-for-a-single-patient"></a>
</h4>
<p>To calculate for a single patient, use the following syntax:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># call egfr.ckdepi.cr.2009 function, and directly set parameters values</span></span>
<span><span class="fu"><a href="../reference/egfr.ckdepi.cr.2009.html">egfr.ckdepi.cr.2009</a></span><span class="op">(</span></span>
<span>  creatinine <span class="op">=</span> <span class="fl">1.4</span>,  </span>
<span>  age <span class="op">=</span> <span class="fl">60</span>,  </span>
<span>  sex <span class="op">=</span> <span class="st">"Male"</span>, </span>
<span>  ethnicity <span class="op">=</span> <span class="st">"White"</span>, </span>
<span>  creatinine_units <span class="op">=</span> <span class="st">"mg/dl"</span>, </span>
<span>  label_afroamerican <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Afroamerican"</span><span class="op">)</span>, </span>
<span>  label_sex_male <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span><span class="op">)</span>, </span>
<span>  label_sex_female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 54.22</span></span>
<span></span>
<span><span class="co"># Definitions of the labels for sex and race are optional if you use the same labels defined as default in the function. The following also works well:</span></span>
<span><span class="fu"><a href="../reference/egfr.ckdepi.cr.2009.html">egfr.ckdepi.cr.2009</a></span><span class="op">(</span></span>
<span>  creatinine <span class="op">=</span> <span class="fl">1.4</span>,  </span>
<span>  age <span class="op">=</span> <span class="fl">60</span>,  </span>
<span>  sex <span class="op">=</span> <span class="st">"Male"</span>, </span>
<span>  ethnicity <span class="op">=</span> <span class="st">"White"</span>, </span>
<span>  creatinine_units <span class="op">=</span> <span class="st">"mg/dl"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 54.22</span></span>
<span></span>
<span><span class="co"># If you measure creatinine in micromol/l, it is possible to omit also 'creatinine_units' since the default value is "micromol/l":</span></span>
<span><span class="fu"><a href="../reference/egfr.ckdepi.cr.2009.html">egfr.ckdepi.cr.2009</a></span><span class="op">(</span></span>
<span>  creatinine <span class="op">=</span> <span class="fl">103</span>, <span class="co"># creatinine is in micromol/l</span></span>
<span>  age <span class="op">=</span> <span class="fl">60</span>,  </span>
<span>  sex <span class="op">=</span> <span class="st">"Male"</span>, </span>
<span>  ethnicity <span class="op">=</span> <span class="st">"White"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 67.7</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-for-a-cohort-of-patients">Example for a cohort of patients<a class="anchor" aria-label="anchor" href="#example-for-a-cohort-of-patients"></a>
</h4>
<p>To calculate eGFR for a cohort of patients in a dataset, use the
following syntax:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># copy as an example the internal dataframe ckd.data from R package to your dataframe</span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="va">ckd.data</span></span>
<span></span>
<span><span class="co"># calculate eGFR by CKD-EPI equation</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">ckdepi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/egfr.ckdepi.cr.2009.html">egfr.ckdepi.cr.2009</a></span><span class="op">(</span></span>
<span>  creatinine <span class="op">=</span> <span class="va">mydata</span><span class="op">$</span><span class="va">cr</span>, age <span class="op">=</span> <span class="va">mydata</span><span class="op">$</span><span class="va">age</span>,</span>
<span>  sex <span class="op">=</span> <span class="va">mydata</span><span class="op">$</span><span class="va">sex</span>, ethnicity <span class="op">=</span> <span class="va">mydata</span><span class="op">$</span><span class="va">ethnicity</span>,</span>
<span>  creatinine_units <span class="op">=</span> <span class="st">"micromol/L"</span>,</span>
<span>  <span class="co"># customize all labels for those used in the data frame if necessary</span></span>
<span>  label_afroamerican <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Black"</span><span class="op">)</span>,</span>
<span>  label_sex_male <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span><span class="op">)</span>, label_sex_female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning in service.check_plausibility.age(age, max_age): There is 1 patient with negative values for age.  This value was substituted to NA.</span></span>
<span><span class="co">#&gt; Warning in service.check_plausibility.age(age, max_age): There is 1 patient with age &gt;100 years.  This value was substituted to NA.</span></span>
<span><span class="co">#&gt; There are 840 patients with age &lt;18 years.  These values were substituted to NA.</span></span>
<span></span>
<span><span class="co"># show descriptive stat for the calculated values</span></span>
<span><span class="co"># note that synthetic data set ckd.data contains input parameters for both adults and children, and since the CKD-EPI equation was developed and validated for adults only, the resulting eGFR values for children will be NA. Use children-specific eGFR equations when necessary.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">ckdepi</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">#&gt;   17.78   35.44   45.19   51.80   59.85  179.11     841</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="advantages-of-the-kidney-epi-package-functions">Advantages of the kidney.epi package functions<a class="anchor" aria-label="anchor" href="#advantages-of-the-kidney-epi-package-functions"></a>
</h3>
There are several advantages of the kidney.epi package functions for
calculating eGFR values:<br><ul>
<li>
<strong>Data workflow is reproducible and based on verified
algorithms</strong>:<br> The kidney.epi package offers a reproducible,
open-source workflow built on verified methods, reducing duplication and
enabling teams to focus on what truly matters: their data and insights.
Thus, every research group should not rewrite the same computational
code from scratch.
</li>
<li>
<strong>Control for input values</strong>:<br> If some input values
are not plausible (negative values for age or creatinine, age exceeding
logical limits, etc) or not suitable for a given eGFR equation
(applicable only to children or only to adults) - they will be omitted,
and thus in the output there will be only robust results.
</li>
<li>
<strong>Possibility to use different measurement units for
creatinine</strong>:<br> There is no need to decode creatinine values
in your data set. Just define in the ‘creatinine_units’ parameter
whether your data contain values in micromol/L, mmol/L or mg/dL - and
the rest will be processed by the function.
</li>
<li>
<strong>Flexible label handling for enhanced usability</strong>:<br>
The function offers a high degree of flexibility by allowing you to
define custom labels that match the labels used in your data frame. This
ensures consistent interpretation of data without needing to modify the
original dataset. Thus, you don’t need to decode labels in your data
frame, just define which of your labels correspond to males, females,
and other parameters.<br> Take into account the following examples:
<ul>
<li>
If the data frame has only label “Male” for males, you can skip the
definition because this is already assumed by the function, or define
for clarity <em>label_sex_male = “Male”</em>.
</li>
<li>
Consider that labels are case-sensitive, and thus be attentive to “Male”
and “male” or similar definitions.
</li>
<li>
If your data frame uses different labeling conventions, you can easily
adjust the labels in the function parameters to align with your data.
For example, if you data frame contains labels “F” for females and “M”
for males, you have to indicate the labeling in parameters of the
function as <em>label_sex_male = “M”, label_sex_female = “F”</em>.
</li>
<li>
The functions support also multiple labels in non-standard or mixed
data. If you’re working with data that hasn’t been fully standardized —
where the same category might have different labels — the function
allows you to define multiple values as valid labels for the same
category.<br> For example, if male sex is represented by both “male”
and “hombre” labels and female sex by both “female” and “mujer” labels,
you can define: <em>label_sex_male = c(“male”, “hombre”),
label_sex_female = c(“female”, “mujer”)</em>.<br> If male sex is
represented by both “male” and 1, you can define: <em>label_sex_male =
c(“male”, 1)</em>.<br> If male sex is represented by both “male” and
“Male” (case-sensitive), you can define: <em>label_sex_male = c(“male”,
“Male”)</em>.
</li>
</ul>
</li>
<li>
As the result, there is no need to modify the original dataset — just
adjust the function parameters instead. This saves time and reduces data
preprocessing efforts, as well as improve the code readability.
</li>
</ul>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>References for each eGFR equation are listed in the documentation to
the package.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer" style="display: flex; justify-content: space-between; align-items: center;">
  <p>Developed by <a href="https://www.linkedin.com/in/boris-bikbov" target="_blank" class="external-link">Boris Bikbov</a>, <a href="https://Scientific-Tools.Org" target="_blank" class="external-link">Scientific-Tools.Org</a></p>
  <p>Built with <a href="https://pkgdown.r-lib.org" target="_blank" class="external-link">pkgdown</a></p>
</div>

    </footer>
</div>





  </body>
</html>
